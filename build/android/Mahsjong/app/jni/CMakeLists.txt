# PROJECT CMAKE FILE
# This file is autogenerated by the creator script
cmake_minimum_required(VERSION 3.10)
if(POLICY CMP0077)
	set(CMAKE_POLICY_DEFAULT_CMP0077 NEW)
endif()

# set the project name and version
project(mahsjong VERSION 1.0)

# specify the C++ standard
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED True)

# Add Android specific features
if (ANDROID)
	include(AndroidNdkModules)
	if (${ANDROID_ABI} STREQUAL "armeabi-v7a")
		# armeabi-v7a requires cpufeatures library
		android_ndk_import_module_cpufeatures()
	endif()
endif()

# Set the correct directories
set(CUGL_DIR  "${PROJECT_SOURCE_DIR}/../../../../../../cugl")
set(SDL2_DIR  "${CUGL_DIR}/sdlapp")
set(BOX2_DIR  ${CUGL_DIR}/external/box2d)
set(WRTC_DIR  ${CUGL_DIR}/external/libdatachannel)
set(POLY2_DIR  ${CUGL_DIR}/external/poly2tri)
set(ASSET_DIR  "${PROJECT_SOURCE_DIR}/../../../../../assets")

list(APPEND EXTRA_INCLUDES "${SDL2_DIR}/include")
list(APPEND EXTRA_INCLUDES "${CUGL_DIR}/include")
list(APPEND EXTRA_INCLUDES "${BOX2_DIR}/include")
list(APPEND EXTRA_INCLUDES "${POLY2_DIR}/include")
list(APPEND EXTRA_INCLUDES "${WRTC_DIR}/include")


# Add the CUGL project
set(CUGL_AUDIO ON)
set(CUGL_SCENE2 ON)
set(CUGL_SCENE3 OFF)
set(CUGL_PHYSICS2 OFF)
set(CUGL_NETCODE ON)
set(CUGL_PHYSICS2_DISTRIB OFF)
add_subdirectory(${CUGL_DIR}/buildfiles/android/jni/cugl "cugl.dir")
list(APPEND EXTRA_LIBS cugl)

# Add the SDL App project
add_subdirectory(${SDL2_DIR}/buildfiles/cmake "sdl2pckg.dir")
list(APPEND EXTRA_LIBS SDL2_pckg)

# Add any external libraries


# Add the source code
file(GLOB SOURCE_FILES
    ${PROJECT_SOURCE_DIR}/../../../../../source/*.cpp
    ${PROJECT_SOURCE_DIR}/../../../../../source/*.h)

# Build and link
set(ANDROID_LIBS GLESv1_CM GLESv2 GLESv3 log android)
add_library(main SHARED)
target_sources(main PRIVATE ${SOURCE_FILES})
target_include_directories(main PUBLIC
                           "${PROJECT_BINARY_DIR}"
                            ${EXTRA_INCLUDES}
                           )
target_link_libraries(main ${EXTRA_LIBS} ${ANDROID_LIBS})

